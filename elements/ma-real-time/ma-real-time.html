<link rel="import" href="../../elements/ma-repos/notification-repo.html">
<polymer-element name="ma-real-time">
    <template>
        <notification-repo id="repo"></notification-repo>
    </template>
    <script>
        Polymer('ma-real-time', {
            polling: 3000,
            getNotifications: function () {
                var self = this;
                self.async(function () {
                    self.getNotificationsCall();
                }, null, self.polling);
            },
            ready: function () {
                this.getNotifications();
            },
            getNotificationsCall: function () {
                this.$.repo.getNotifications(this.getNotificationsCallback, this);
            },
            getNotificationsCallback: function (notifications, self) {
                if(notifications.length > 0){
                    self.fire("new-notifications", notifications);
                }
                self.getNotifications();
            }
        });
    </script>
</polymer-element>